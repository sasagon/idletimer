language: C

compiler:
  - gcc
  - clang

os:
  - linux

before_install:
  - sudo apt-get -qq update
  - sudo apt-get -qq install libx11-dev libgtk2.0-dev libxss-dev libcunit1-dev

before_script:
  - "echo *** dump /etc/init.d/Xvfb:"
  - "cat /etc/init.d/Xvfb"
  - "echo ***"
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - "LD_PRELOAD='' /sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -ac -screen 0 640x480x24 -extension RANDR"
  - sleep 3 # give xvfb some time to start
  - autoreconf -i

script: ./configure && make && make check && make distcheck

addons:
  artifacts: true
